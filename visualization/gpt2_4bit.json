{
  "checkpoint": "gpt2",
  "config": {
    "experiment_name": "lora_gpt2_e2e",
    "seed": 42,
    "output_dir": "./results",
    "model_name": "gpt2-medium",
    "dataset_name": "e2e_nlg",
    "sample_percentage": 0.1,
    "max_length": 256,
    "training": {
      "learning_rate": "2e-4",
      "weight_decay": 0.01,
      "num_epochs": 5,
      "batch_size": 8,
      "warmup_steps": 500,
      "label_smoothing": 0.1,
      "max_grad_norm": 1.0,
      "gradient_accumulation_steps": 1,
      "logging_steps": 100,
      "eval_steps": 500,
      "save_steps": 500,
      "save_total_limit": 3,
      "early_stopping_patience": null
    },
    "lora": {
      "rank": 4,
      "alpha": 32,
      "dropout": 0.1,
      "target_modules": [
        "c_attn",
        "c_proj"
      ]
    },
    "evaluation": {
      "metrics": [
        "perplexity",
        "bleu",
        "rouge"
      ],
      "generation": {
        "num_samples": -1,
        "max_new_tokens": 50,
        "temperature": 1.0,
        "top_p": 0.9,
        "do_sample": true
      },
      "inference": {
        "beam_size": 10,
        "length_penalty": 0.9,
        "no_repeat_ngram_size": 4
      }
    }
  },
  "timestamp": "20260129_195618",
  "metrics": {
    "perplexity": 15354.019024266276,
    "bleu": 0.014487582347734403,
    "sacrebleu": 0.007536801081871613,
    "rouge1": 0.2932022669075845,
    "rouge2": 0.11952808559286957,
    "rougeL": 0.21952462536105904
  },
  "examples": [
    {
      "mr": "name[Blue Spice], eatType[coffee shop], area[city centre]",
      "prediction": "name[Coffee Shop], area[town centre] | name: name[Coffee Shop], eatType: coffee shop, area: city centre, reference: name, eatType: cafe, area: town centre, name: name,",
      "num_references": 2,
      "sample_reference": "A coffee shop in the city centre area called Blue Spice."
    },
    {
      "mr": "name[Blue Spice], eatType[coffee shop], area[riverside]",
      "prediction": "name[Coffee Shop], drinkType[drink], area[rooftop] | name: name, drink: drink, area: area, reference: reference, eatType: eatType, eat: eat, drinkType: drink",
      "num_references": 2,
      "sample_reference": "There is a coffee shop Blue Spice in the riverside area."
    },
    {
      "mr": "name[Blue Spice], eatType[coffee shop], customer rating[5 out of 5], near[Crowne Plaza Hotel]",
      "prediction": "name, eatType, near, customer rating, near_crowne_plaza_hotel, customer_rating, near_coffee_shop, near_hotel_closest_to_crown_plaza,",
      "num_references": 3,
      "sample_reference": "The coffee shop Blue Spice is based near Crowne Plaza Hotel and has a high customer rating of 5 out of 5."
    }
  ],
  "eval_info": {
    "unique_mrs_evaluated": 111,
    "total_unique_mrs": 111,
    "total_test_samples": 469,
    "avg_refs_per_mr": 4.225225225225225
  }
}